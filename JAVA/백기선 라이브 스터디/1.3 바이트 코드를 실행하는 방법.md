## 3\. JDK와 JRE

![image](https://github.com/binary-ho/TIL-public/assets/71186266/4593ddf7-4bd7-47f3-9012-0e4405433dea)

JDK는 Java Development Kit의 약자로, 자바 개발 환경을 의미한다.

자바 프로그램을 개발을 위한 '도구'들을 가지고 있다.

이렇게 말하니 사실 와닿지 않는다.

컴파일 할때 쓰이던 javac가 JDK에 속해 있다.

그 외에도 위 그림과 같이 역 어셈블러 디버거, 의존관계 분석 툴 등이 존재한다.

예시를 봐도 엄청 와닿지는 않는다.

그리고 내부적으로 자바 실행 환경인 JRE를 가지고 있다.

JRE는 자바 실행 환경으로, 자바 실행 명령과

바이트 코드 실행에 필요한 다양한 클래스 라이브러리를 제공해 준다.

java lang, util 과 같은 런타임 패키지를 가지고 있다. 

또한 클래스 라이브러리도 이곳에 위치하고 있다.

그리고 JVM은 실질적으로 기계에 닿기 위한 인터프리터와 JIT 컴파일러, 링커 등을 가지고 있다.

정확한 분류는 절대 아니지만 이렇게 생각하면 조금 낫다.

컴파일은 JDK의 javac를 통해, 컴파일된 바이트 코드는 JRE의 java 명령어를 통해 실행 가능하다.

그러면 JVM이 돌아가게 되고, 바이트 코드들이 실제로 수행되기 시작한다.

이런 JDK와 JRE는 OS나 CPU에 독립적이다.

종속적인 것은 JVM 뿐이다. 

JVM이 '기계'에 해당한다고 했다.

JDK와 JRE는 재밌게도 각각 App과 실행 환경과 같은 역할을 한다.

그러니까, 앱 : OS : 하드웨어 == JDK : JRE : JVM이라고 생각할 수도 있다는 것이다.

## 4\. 바이트 코드를 실행하는 법

바이트 코드를 실행하는 방법에 대해 좀 더 자세히 알아보자.

Java App을 실행시키는 방법은 다음과 같다.

1\. java 명령어를 입력한다.

2\. 그러면 JRE가 시작되고,

3\. 지정된 클래스를 로드하고,

4\. 해당 클래스의 main() 메서드를 호출한다.

여기서 '지정된' 클래스 라는건 java 명령어를 입력할 때 지정된 클래스를 말한다.

실행시킬 클래스를 딱 지정하고, java명령어를 입력하면 내부의 main() 메서드를 실행시킨다는 것인데,

그 main() 메서드가 가져야 할 규칙은 아래와 같다.

> The method must be declared **'public'** and **'static'**,  
> it must **not return any value**,  
> and it must accept a **String  array** as a parameter.

1\. public static으로 선언 되어야 한다.

2\. 리턴 값이 없어야 한다.

3\. String Array를 파라미터로 받아야 한다.

별거 없다 그냥 아래와 같이 자주 보는 형태면 된다.

![image](https://github.com/binary-ho/TIL-public/assets/71186266/a93b600e-8a17-4977-8863-757d4e619f68)

이런 형태의 main 메서드를 가진 클래스 파일을 실행항 때,

구체적인 명령어의 예시는 아래와 같다.

![image](https://github.com/binary-ho/TIL-public/assets/71186266/eec9f7a8-66d2-47e8-8985-41fcc422c90c)

첫 번째는 클래스 파일로, 두 번째는 JAR 파일로 시작하는 예시이다.

다양한 방식으로 앱을 실행할 수 있는데,

나는 서버에서 실제로 앱을 실행할 때 주로 JAR 파일을 통해 실행했다.

JAR 파일은 java 앱을 효율적으로 배포할 수 있는 수단으로,

자바 앱을 구성하는 클래스나 리소스들을 단 하나의 파일로 압축한 형태이다.

실제로 ZIP 파일 포멧 압축 파일의 일종으로,

JDK 'jar' 명령어로 압축해 만들거나 압축 해제할 수 있다.

(JRE java.util.zip 패키지를 통해서도 읽고 쓸 수 있다.)

내부적으로 설정 파일인 MAIFEST 파일을 가지고 있는데

이런 매니패스트 파일에 JAR를 실행시키기 위한 메인 클래스 위치인 엔트리 포인트나

패키지 관련 데이터 등의 앱을 위한 메타 데이터들이 포함되어 있다.

이런 매니패스트 파일을 읽고 시작점이 되는 메인 클래스를 찾아내는 것이다.

JRE 실행

java 명령어를 입력하여 JRE가 실행되면,

JVM이 실행되고, **클래스 로더**에 의해 main 메서드가 포함된 클래스를 로딩해서

JVM이 할당한 메모리의 메서드 영역에 올린다.

이러한 최초 실행 클래스를 **initial calss**라고 부른다.

이후 다른 언어의 컴파일 과정에서 발생하는 Link 과정이 여기서도 일어나게 된다.

그 다음 static method 등 initialization method를 실행한다. (여기서는 main 메서드가 static)

이런 과정을 Initialize라고 한다.

그래서 Loading  -> Link -> Initialize 순서로 진행된다.

- 자바 최적화 <벤저민 J. 에번스, 제임스 고프, 크리스 뉴랜드 저>

- 스프링 입문을 위한 자바 객체 지향의 원리와 이해 <김종민 저>

- [자바 컴파일에서 실행까지] 

- [Oracle Tools Reference]
