# 5.4.3 Disk Arm Scheduling Algorithm

디스크 블록을 읽거나 쓰는데 걸리는 시간은 아래 3가지 요소에 의해 결정된다
1. **Seek Time:** 탐색 시간 - 원하는 cylinder에 Arm을 옮기는 시간
2. **Rotational Delay:** 회전 지연 - 원하는 섹터를 헤드 밑으로 오도록 회전하는 시간
3. Actual transfer time: 실제 데이터 전송 시간

대부분에 디스크는 **Seek Time이 다른 탐색보다 오래 걸린다.** 즉, 읽거나 쓰는데 걸리는 시간은 **Seek Time에 지배된다.** <br>
그러므로, 이 탐색 시간을 잡는 것이, 시스템 성능 향상에 큰 도움이 된다. <br>
이런 Disk Arm의 이동을 Scheduling하는 4가지 알고리즘을 살펴보고, 헤드 이동 횟수가 response time과 비례한다고 생각하고, 이동 횟수를 한번 세어 보자. <br>

예시를 보일 것이다. <br> 
모든 입력에 대해, 현재 11번 실린더에 있고, 입력은 <br>
`1, 36, 16, 34, 9, 12` 순서로 들어왔다. (지연 이동으로 입력을  여러개 받고 이동)

## 1. FCFS (First-Come, First-Served)
이름 그대로, 먼저 오는 것을 먼저 처리한다.
queue와 같은 형태! <br>
ex) 11 -> 1 -> 36 -> 16 -> 34 -> 9 -> 12 <br>
직접 세어 보면, 무려 111회 이동

## 2. SSF (Shortest Seek First)
가장 인접한 요청을 다음에 처리하자는 생각! <br>
각 실린더 사이를 이동하는 Seek Time이 Shortest한 실린더 부터 이동하자는 것이다! <br>
ex) 11 -> 12 -> 9 -> 16 -> 1 -> 34 -> 36 <br>
**총 61회 이동!** 확실히 짧아졌다 <br>
가까운 곳 부터 가니까 확실히 이동 수가 적어졌다. 이 방식에도 단점은 있는데, **끝 자락에 있는 애들이 poor service를 받을 수 있다는 것이다.** <br>
예를 들어 현재 헤드 위치와 멀리 있는 실린더 이동 요청이 초기 부터 들어와 있었다고 생각해보자. 그런데 자꾸 현재 헤드 위치와 가까운 실린더로의 이동 요청이 자꾸만 들어온다면, **먼 헤드 쪽의 요청은 계속해서 기다릴 수 밖에 없다.. Poor Service..**


## 3. Scan Algorithm (Elevator Algorithm)
스캔 알고리즘은, **현재 이동중인 방향으로 계속 나아가며 헤드를 이동하는 방식이다.** <Br>
무슨 말이냐면 1에서 2로 이동중이였다면, 숫자가 커지는 방향으로 마지막 요청 부분까지 쭉~~ 이동하자는 아이디어다. <br> 
**upward 일 때,** <br>
ex) 11 -> 12 -> 16 -> 34 -> 36 -> 9 -> 1 <br>
이런 움직임을 보인다. **총 60회 이동!** <br>
이 방법의 경우 **현재 이동 방향을 저장하기 위한 bit가 필요하고,** <br>
**전체 이동 수의 상한이 2*(number of cylinder)로 제한 되어 있다.** 이는 당연하다. 최악의 경우 실린더를 upward로 한번, downward로 또 한번 이동할 뿐이기 때문이다. <br>
**SSF가 기본적으로는 Scan 보다 좋다고 알려져 있다.** 이동이 마치 엘리베이터와 같다고 해서 엘리베이터 알고리즘이라고도 불린다.

## 4. C-Scan Algorithm (Circular-Scan Algoritm)
Scan과 대체로 비슷하다. 대신 '논리적으로' 아예 쭉 한 방향으로만 이동하는데, 예시를 먼저 보자.
ex) 11 -> 12 -> 16 -> 34 -> **36 -> 1** -> 9 <br>
잘 보면, 36번 이후 1번으로 다시 가는 것을 볼 수 있다. <br> 
실제로 실린더들은 **당연히** **수평으로 놓여져 있기 때문에,** 논리적인 흐름일 뿐이다. <br>
그렇게 때문에 이동 헤드 수를 세는 것이 애매하다. <br>
**다만, 이 방법은 Scan 알고리즘에 비해, Response Time의 분산이 작다고 알려져 있다!** <Br>
이 점이 다른 점이므로, 잘 알아두자.


## 5. 다른 최적화
디스크 Seek Time이 회전 지연보다 훨씬 바르다면, 다른 최적화가 적용되어야 한다.

디스크 컨드롤러는 단 하나의 요청이 있더라도 항상 여러 섹터를 읽고 캐시한다. 일반적으로 한 섹터에 대한 읽기 요청은, 컨트롤러의 캐시 메모리 공간의 크기 정도에 따라 **주변 섹터들, 심지어 트랙 전체 섹터들을 읽어들이게 된다.** <br>
디스크 컨트롤러 캐시는 OS 캐시와 완전히 독립적이다.디스크 컨트롤러 캐시는 헤드의 밑에 있어, **요청 되지도 않은 블럭들을 많이 보유하고 있다.** OS 캐시와 완전히 방식이 다른 것이다.

## Reference
- Modern Operating Systems <ANDRWE S. TANENBAUM 저>
